% Update 5/12/2024
\vfil\penalty-200\vfilneg
\section{Thảo luận và Mở rộng}

\subsection{Nhận xét dữ liệu}
\begin{itemize}
    \item  Trong mô hình tổng quan, có những cột dữ liệu không tuân theo phân phối chuẩn như \textbf{order\_total} và \textbf{order\_price}. Điều này có thể do sự hiện diện của các giá trị ngoại lai hoặc phân phối không đồng nhất.
    \item Phương sai không đồng nhất , có thể do sự biến động lớn trong giá trị đơn hàng giữa các mùa. 
    \item Có những cột phụ thuộc với nhau, ví dụ \textbf{order\_price} ảnh hưởng bởi \textbf{coupon\_discount}.

\end{itemize}

\subsection{Tính bao quát}

Nhóm đã phân tích các yếu tố ảnh những ảnh hưởng đến sự thay đổi của dữ liệu, cũng như phân tích và kiểm định trong từng trường hợp như sau:
Các kiểm định được chọn phù hợp với mục tiêu và đặc điểm dữ liệu (không chuẩn, không đồng nhất phương sai, có cặp). Ngoài ra, nhóm cũng mở rộng bằng kiểm định hậu nghiệm (Dunn Test) để phân tích sâu hơn sau Kruskal-Wallis. Do đó, phân tích được đánh giá là có tính bao quát tốt và hợp lý về mặt phương pháp.
Cụ thể các phương pháp đã được nhóm sử dụng như sau: 
\begin{itemize}
    \item Phân tích 1 mẫu với \textbf{z-test}
    \item Phân tích 2 mẫu với \textbf{t-test}
    \item Phân tích Annova \textbf bằng {Krustal-Wallis}
    \item Phân tích hồi quy tuyến tính
\end{itemize}
\subsection{Điểm mạnh và điểm yếu của các phương pháp đã sử dụng}

\begin{table}[H]
\centering
\caption{Tổng hợp ưu điểm và nhược điểm của các phương pháp kiểm định}
\label{tab:summary_tests}
\renewcommand{\arraystretch}{1} % Giãn dòng trong bảng
\begin{tabular}{|p{3.2cm}|p{5.5cm}|p{5.5cm}|}
    
\hline
\textbf{Phương pháp} & \textbf{Ưu điểm} & \textbf{Nhược điểm} \\ \hline
% 1 mẫu
\textbf{Z-test một mẫu} &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
\item Dễ hiểu và triển khai.
    \item Hiệu quả với cỡ mẫu lớn (n > 30).
    \item Không yêu cầu phân phối chuẩn nhờ định lý giới hạn trung tâm.
\end{itemize} &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
    \item Giả định dữ liệu độc lập, mẫu đại diện.
    \item Không phù hợp với cỡ mẫu nhỏ.
\end{itemize} \\ \hline
% 2 mẫu
\textbf{T-test hai mẫu (Welch)} &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
    \item So sánh hai nhóm độc lập.
    \item Không yêu cầu phương sai bằng nhau.
\end{itemize} &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
    \item Nhạy cảm với ngoại lai nếu dữ liệu không chuẩn.
    \item Cần số lượng mẫu đủ lớn nếu phân phối không chuẩn.
\end{itemize} \\ \hline
% Annova
\textbf{Kruskal-Wallis } trong Annova &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
    \item Thay thế ANOVA khi dữ liệu không chuẩn.
    \item So sánh $\geq$ 3 nhóm độc lập.
    \item Không yêu cầu phương sai đồng nhất.
\end{itemize} &
\begin{itemize}[leftmargin=*, topsep=0pt, partopsep=0pt, parsep=0pt, itemsep=0pt]
    \item Không chỉ ra cặp nhóm nào khác biệt.
    \item Cần kiểm định hậu nghiệm (như Dunn Test).
\end{itemize} \\ \hline

\end{tabular}
\end{table}
\subsection{Mối quan hệ giữa mục tiêu và phương pháp được chọn}

\begin{itemize}
    \item Phân tích hồi quy thường dùng để xây dựng mô hình dự đoán hoặc mô hình hóa mối quan hệ tuyến tính giữa biến phụ thuộc và biến độc lập.
    \item Trong khi đó, bài toán của nhóm tập trung vào việc kiểm tra:
    \begin{itemize}
        \item \textbf{Sự khác biệt giữa các nhóm (mùa):} Dùng Kruskal-Wallis và Wilcoxon-Mann-Whitney.
        \item \textbf{Sự khác biệt giữa các giá trị trong cùng một nhóm:} Dùng Wilcoxon Signed Rank.
    \end{itemize}
    \item Việc lựa chọn kiểm định không tham số phản ánh mục tiêu phân tích cụ thể mà không phụ thuộc vào các giả định phức tạp về phân phối dữ liệu.
\end{itemize}

\noindent
\textbf{Kết luận:}  
Phân tích hồi quy không được chọn vì:
\begin{itemize}
    \item Dữ liệu vi phạm các giả định quan trọng (phân phối chuẩn, phương sai đồng nhất).
    \item Mục tiêu của nhóm không phải dự đoán giá trị mà là kiểm tra sự khác biệt thống kê.
\end{itemize}
Các kiểm định không tham số được chọn phù hợp hơn, chính xác hơn, và cung cấp kết quả giải thích trực tiếp liên quan đến câu hỏi bài toán.

\subsection{Mở rộng: Dunn Test}
% Dàn ý:
% Mở rộng phương pháp Krustal-Wallis
% Nêu ra những điểm mạnh , điếm yếu của 3 phương pháp trên
Sau khi đưa ra những điểm mạnh hay giới hạn những phương pháp nhóm đã sử dụng ở trên. Nhóm quyết định sẽ mở rộng phương pháp \textbf{Krustal-Wallis} 
Như đề cập ở trên, phương pháp kiểm định KW chỉ đưa ra được "bề nổi" hay chỉ kiểm tra sự khác biệt tổng thể giữa các nhóm.

\noindent Nhóm sẽ áp dụng phương pháp hậu nghiệm (pos-hoc) để tìm ra cụ thể nhóm nào có sự khác biệt. Nhóm đề xuất sử dụng \textbf{Dunn Test}.

\begin{lstlisting}[language=R,caption=Thực hiện phân tích Pos Hoc trong R]
dunn_result <- dunn.test(merged_data$order_price, merged_data$season, method = "bonferroni", list = TRUE)
# Tạo bảng kết quả
table <- cbind.data.frame(
  Comparison = dunn_result$comparisons,  # Các cặp so sánh (cụ thể mùa)
  Z_value = dunn_result$Z,               # Giá trị Z
  P_adjusted = dunn_result$P.adjusted    # P-value đã điều chỉnh
)
# Sắp xếp bảng theo p-value đã điều chỉnh
table <- table[order(table$P_adjusted), ]
# Tạo bảng với gt và thêm tiêu đề
table %>%
  gt() %>%
  tab_header(
    title = md("#### Kết quả phân tích pos-hoc (Dunn's Test)"),
    subtitle = "So sánh sự khác nhau giữa các nhóm mùa bằng Bonerroni"
  )

\end{lstlisting}
\subsection{Kết quả}
% Table

\begin{table}[H]
\centering
\begin{tabular}{|l|r|r|} % Cột: l (trái), r (phải), r (phải)
\hline
\textbf{Các mùa} & \textbf{Z-value} & \textbf{P.adjusted} \\ \hline
autumn - winter     & 1.4580097        & 0.4345136           \\ \hline
autumn - spring     & 0.8823710        & 1.0000000           \\ \hline
autumn - summer     & 0.6008488        & 1.0000000           \\ \hline
spring - summer     & -0.2722941       & 1.0000000           \\ \hline
spring - winter     & 0.6104089        & 1.0000000           \\ \hline
summer - winter     & 0.8656661        & 1.0000000           \\ \hline
\end{tabular}
\caption{Post-hoc Analysis Results (Dunn's Test)}
\label{tab:dunn_results}
\end{table}
% End table

    \textbf{Kết luận:}
    Sau khi xuất ra kết quả Dunn Test, tổng quan các mùa đều có khác biệt gì lớn.
\input{Sections/7_Nguon_Du_Lieu_R}
